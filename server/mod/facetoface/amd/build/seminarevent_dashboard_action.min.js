define([],function(){function a(){var a=document.documentElement||document.body.parentNode;if("number"!=typeof a.clientWidth&&(a=document.body),"number"==typeof document.clientWidth)return{width:document.clientWidth,height:document.clientHeight};var b,c,d=document.body,e=document.defaultView||window;return a===d||(b=Math.max(a.clientWidth,d.clientWidth))>e.innerWidth||(c=Math.max(a.clientHeight,d.clientHeight))>e.innerHeight?{width:d.clientWidth,height:d.clientHeight}:{width:b,height:c}}function b(a){var b="mod_facetoface_event-action:";return b+=1===arguments.length?a:Array.prototype.reduce.call(arguments,function(a,b){return a+":"+b}),M.util.js_pending(b),function(){M.util.js_complete(b)}}function c(a){return this instanceof c?void this._init(a):new c(a)}function d(a){return this instanceof d?void this._init(a):new d(a)}c.OPEN_EVENT="mod_facetoface:dropdown.open",c.CLOSED_EVENT="mod_facetoface:dropdown.closed",function(){var d={TAB:9,ENTER:13,ESCAPE:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40};this.constructor=c,this._init=function(a){if(!a.matches(".mod_facetoface__sessionlist__action__dropdown"))throw new Error("DD: not a dropdown button");if(this.el=a,this.parent=a.closest(".mod_facetoface__sessionlist__action__buttons"),null===this.parent)throw new Error("DD: button group not found");if(this.menu=this.parent.querySelector('[data-f2f-dropdown-id="'+a.id+'"]'),null===this.menu)throw new Error("DD: menu not found");this.menuItems=Array.prototype.slice.apply(this.menu.querySelectorAll("li:not(.disabled) > .dropdown-item")).map(function(a){return a.parentNode}),this.scrollTimerId=null,this.scrollDone=null,this.el.setAttribute("aria-expanded","false"),this._onKeyDownMenu=this._onKeyDownMenu.bind(this),this._onScrollOrResize=this._onScrollOrResize.bind(this),this._onClickBackground=this._onClickBackground.bind(this),this._onBlurButton=this._onBlurButton.bind(this),this._onKeyDownButton=this._onKeyDownButton.bind(this),this.el.addEventListener("click",this._onClickButton.bind(this)),this.el.addEventListener("focus",this._onFocusButton.bind(this))},this.isMenuOpen=function(){return this.parent.classList.contains("open")},this.openMenu=function(){return this.parent.classList.add("open"),this.el.setAttribute("aria-expanded","true"),window.addEventListener("click",this._onClickBackground,!0),window.addEventListener("keydown",this._onKeyDownMenu,!0),window.addEventListener("scroll",this._onScrollOrResize,!0),window.addEventListener("resize",this._onScrollOrResize,!0),this._fireEvent(c.OPEN_EVENT),this.repositionMenu()},this.closeMenu=function(a){return this.parent.classList.remove("open"),this.el.setAttribute("aria-expanded","false"),window.removeEventListener("click",this._onClickBackground,!0),window.removeEventListener("keydown",this._onKeyDownMenu,!0),window.removeEventListener("scroll",this._onScrollOrResize,!0),window.removeEventListener("resize",this._onScrollOrResize,!0),this.scrollTimerId&&(window.cancelAnimationFrame(this.scrollTimerId),this.scrollTimerId=null),this.scrollDone&&(this.scrollDone(),this.scrollDone=null),a&&this.el.focus(),this._fireEvent(c.CLOSED_EVENT),Promise.resolve()},this.repositionMenu=function(){this.scrollTimerId&&(window.cancelAnimationFrame(this.scrollTimerId),this.scrollTimerId=null);var c=this;return new Promise(function(d){var e=function(){c.scrollTimerId=null;var b=c.el.getBoundingClientRect(),e=a(),f=b.top+b.height;if(c.menu.style.top=f+"px","rtl"===getComputedStyle(c.el).direction){var g=b.left;g<0&&(g=0),c.menu.style.left=g+"px",c.menu.style.right=""}else{var h=e.width-b.left-b.width;h<0&&(h=0),c.menu.style.left="",c.menu.style.right=h+"px"}c.scrollTimerId=null,c.scrollDone&&(c.scrollDone(),c.scrollDone=null),d()};c.scrollDone=c.scrollDone||b("reposition",c.el.id),c.scrollTimerId=window.requestAnimationFrame(e)})},this.selectItem=function(a){if(this.menuItems.length){a%=this.menuItems.length,a<0&&(a+=this.menuItems.length);var c=this.menuItems[a].querySelector("a"),d=b("selectitem",this.el.id,a);return new Promise(function(a){setTimeout(function(){c.focus(),d(),a()},0)})}return Promise.resolve()},this.openMenuAndSelectItem=function(a){var b=this;return b.openMenu().then(function(){return b.selectItem(a)})},this._fireEvent=function(a){var b=new CustomEvent(a,{bubbles:!0,detail:this});this.el.dispatchEvent(b)},this._onClickButton=function(a){a.preventDefault(),a.stopPropagation(),this.isMenuOpen()?this.closeMenu():this.openMenu()},this._onFocusButton=function(){event.stopPropagation(),this.el.addEventListener("blur",this._onBlurButton),this.el.addEventListener("keydown",this._onKeyDownButton)},this._onBlurButton=function(){event.stopPropagation(),this.el.removeEventListener("blur",this._onBlurButton),this.el.removeEventListener("keydown",this._onKeyDownButton)},this._onKeyDownButton=function(a){if(a.stopPropagation(),this.isMenuOpen())switch(a.keyCode){case d.TAB:a.shiftKey?this.closeMenu():this.selectItem(0);break;case d.ESCAPE:this.closeMenu()}else switch(a.keyCode){case d.DOWN:a.preventDefault(),this.openMenuAndSelectItem(0);break;case d.UP:a.preventDefault(),this.openMenuAndSelectItem(-1);break;case d.ENTER:case d.SPACE:a.preventDefault(),this.openMenuAndSelectItem(0)}},this._onKeyDownMenu=function(a){var b=a.target.closest("li");if(null!==b||a.target===this.el||this.el.contains(a.target)){a.stopPropagation();var c=this.menuItems.indexOf(b);switch(a.keyCode){case d.ESCAPE:a.preventDefault(),this.closeMenu(!0);break;case d.UP:a.preventDefault(),this.selectItem(c<0?c:c-1);break;case d.DOWN:a.preventDefault(),this.selectItem(c+1);break;case d.TAB:a.stopPropagation(),a.shiftKey?c<=0?this.closeMenu(!0):(a.preventDefault(),this.selectItem(c-1)):c>=this.menuItems.length-1?this.closeMenu(!0):(a.preventDefault(),this.selectItem(c+1))}}},this._onClickBackground=function(a){!this.el.contains(a.target)&&this.isMenuOpen()&&setTimeout(function(){this.closeMenu()}.bind(this),0)},this._onScrollOrResize=function(a){a.target!==document&&a.target!==window||!this.isMenuOpen()||this.repositionMenu()}}.call(c.prototype),function(){var a=null;Object.defineProperty(d,"current",{get:function(){return a}}),this.constructor=d,this._init=function(a){this.el=a;var b=a.querySelector(".mod_facetoface__sessionlist__action__dropdown");b&&(this.dropdown=new c(b),a.addEventListener(c.OPEN_EVENT,this._onDropDownOpen.bind(this)),a.addEventListener(c.CLOSED_EVENT,this._onDropDownClosed.bind(this)))},this._onDropDownOpen=function(b){b.detail!==a&&(a=b.detail)},this._onDropDownClosed=function(b){b.detail===a&&(a=null)}}.call(d.prototype);var e={init:function(a){return new Promise(function(b){var c=new d(a);b(c)})},update:function(){var a=d.current;a&&a.repositionMenu()}};return e});