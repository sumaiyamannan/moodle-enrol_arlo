define(["core/templates","core/str"],function(a,b){function c(a){0!==a.learningitems.length&&(g=document.getElementById("inst"+a.instanceid),i=g.querySelector(".panel-footer"),h=g.querySelector(".block_current_learning-tiles ul"),j=a.pagination,j.pagination=!0,l=Math.ceil(j.totalitems/j.itemsperpage),k=a.learningitems,d())}function d(){g.addEventListener("click",e)}function e(a){var b=a.target.closest("a");if(b&&b.hasAttribute("data-page")&&(a.preventDefault(),!b.parentElement.classList.contains("disabled"))){var c=b.getAttribute("data-page");"next"===c?j.currentpage+=1:"prev"===c?j.currentpage-=1:j.currentpage=parseInt(c),f()}}function f(){j.previousclass=1===j.currentpage?"disabled":"",j.nextclass=j.currentpage===l?"disabled":"";var c=(j.currentpage-1)*j.itemsperpage,d=Math.min(j.currentpage*j.itemsperpage,j.totalitems),e=k.slice(c,d),f={end:d,start:c+1,total:k.length};j.pages.forEach(function(a){a.page==j.currentpage?a.active="active":a.active=""}),M.util.js_pending("block_current_learning-updated");var i=b.get_string("displayingxofx","block_current_learning",f).then(function(b){return j.text=b,a.render("block_current_learning/paging",j)}).then(function(b,c){return g.querySelector(".panel-footer").outerHTML=b,a.runTemplateJS(c)}),m=e.map(function(b){return a.render("block_current_learning/tile",b)}),n=Promise.all(m).then(function(a){h.innerHTML=a.join("")});return Promise.all([i,n]).then(function(){M.util.js_complete("block_current_learning-updated")})}var g,h,i,j,k,l;return{init:c}});